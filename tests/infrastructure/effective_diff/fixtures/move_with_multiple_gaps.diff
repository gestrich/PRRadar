diff --git a/processor.py b/processor.py
--- a/processor.py
+++ b/processor.py
@@ -1,10 +1,0 @@
-def process(data):
-    step1(data)
-    x = transform(data)
-    validate(x)
-    y = compute(x)
-    log(y)
-    z = finalize(y)
-    if z.ready:
-        emit(z)
-    cleanup()
diff --git a/handler.py b/handler.py
--- a/handler.py
+++ b/handler.py
@@ -0,0 +1,10 @@
+def process(data):
+    step1(data)
+    x = transform_v2(data)
+    validate(x)
+    y = compute(x)
+    log(y)
+    z = finalize(y)
+    if z.ready:
+        emit_async(z)
+    cleanup()
